<!DOCTYPE HTML>
<html  lang="zh" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-project-add">
			<div class="form-group">	
				<label class="col-sm-3 control-label">项目名称：</label>
				<div class="col-sm-8">
					<input id="proname" name="proname" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">项目上传：</label>
				<div class="col-sm-8">
					<input id="files" name="files" class="form-control" type="file">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">项目类别：</label>
				<div class="col-sm-8">
					<input id="protype" name="protype" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">投资金额：</label>
				<div class="col-sm-8">
					<input id="money" name="money" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">开支明细：</label>
				<div class="col-sm-8">
					<input id="moneynote" name="moneynote" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">项目内容：</label>
				<div class="col-sm-8">
					<input id="content" name="content" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">项目地址：</label>
				<div class="col-sm-8">
					<input id="address" name="address" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">负责人姓名：</label>
				<div class="col-sm-8">
					<input id="fname" name="fname" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">负责人手机号：</label>
				<div class="col-sm-8">
					<input id="fphone" name="fphone" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label">项目发布日期：</label>
				<div class="col-sm-8">
					<input id="pushdate" name="pushdate" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">发布人姓名：</label>
				<div class="col-sm-8">
					<input id="uname" name="uname" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">是否有效：</label>
				<div class="col-sm-8">
					<input id="remark" name="remark" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">项目状态：</label>
				<div class="col-sm-8">
					<input id="type" name="type" class="form-control" type="text">
				</div>
			</div>
		</form>
	</div>
    <div th:include="include::footer"></div>
	<script type="text/javascript">
		var prefix = ctx + "village/project"
		// 检测是否选择文件，如果选择，返回文件对象;如果没选择，返回false
		function checkFile(){
			// 获取文件对象(该对象的类型是[object FileList]，其下有个length属性)
			var fileList = $('#files')[0].files;

			// 如果文件对象的length属性为0，就是没文件
			if (fileList.length === 0) {
				console.log('没选择文件');
				return false;
			};
			return fileList[0];
		};

		function aa(){
			let  file = checkFile();
			let size = file.size;
			console.log("文件大小",size);
			//获取录音时长
			let url = URL.createObjectURL(file);
			let audioElement = new Audio(url);
			let duration = audioElement.duration/60; //音频长度 视频不行
			$("#flenth").attr("value",duration);
			$("#fsize").attr("value",size);
			console.log(duration,size)
		};
		function submitHandler() {
			aa();
			$.modal.loading("正在处理中，请稍后...");
			if (!checkFile()) {
				alert('请先选择文件');
				return false;
			}
			else{
				$("#form-filemanager-add").submit();
				$(function(){
					/** 验证文件是否导入成功  */
					$("#form-filemanager-add").ajaxSubmit(function (data) {
						$.operate.successCallback({"code":data.code,"msg":data.msg});
						//alert("post success." + data.code+"--"+data.msg);
					});
					return false;
				});
			}
		}
		function sleep(numberMillis) {
			var now = new Date();
			var exitTime = now.getTime() + numberMillis;
			while (true) {
				now = new Date();
				if (now.getTime() > exitTime)
					return;
			}
		}
	</script>
	<script>
		$(document).ready(function(){Dropzone.options.myAwesomeDropzone={autoProcessQueue:false,uploadMultiple:true,parallelUploads:100,maxFiles:100,init:function(){var myDropzone=this;this.element.querySelector("button[type=submit]").addEventListener("click",function(e){e.preventDefault();e.stopPropagation();myDropzone.processQueue()});this.on("sendingmultiple",function(){});this.on("successmultiple",function(files,response){});this.on("errormultiple",function(files,response){})}}});
	</script>
	<script th:src="@{/js/plugins/dropzone/dropzone.js}"></script>
	<script th:src="@{/js/jquery-form.js}"></script>
</body>
</html>
